import { Class103 } from 'Class103.js';
import { Class676 } from 'Class676.js';
import { Class635 } from 'Class635.js';
import { Class49 } from 'Class49.js';
import { Class41 } from 'Class41.js';
import { Class678 } from 'Class678.js';
import { Class636 } from 'Class636.js';
import { Class546 } from 'Class546.js';
import { Class673 } from 'Class673.js';
import { Class443 } from 'Class443.js';
import { Class677 } from 'Class677.js';
import { Class298 } from 'Class298.js';
import { Class448 } from 'Class448.js';
import { Class453 } from 'Class453.js';
import { Class605 } from 'Class605.js';
import { Class545 } from 'Class545.js';
import { Class302 } from 'Class302.js';
import { Class105 } from 'Class105.js';
import { Class95 } from 'Class95.js';
import { Class96 } from 'Class96.js';
import { Class93 } from 'Class93.js';
import { Class80 } from 'Class80.js';
import { Class148 } from 'Class148.js';
import { Class423 } from 'Class423.js';
import { Class131 } from 'Class131.js';
import { Class604 } from 'Class604.js';
import { Class86 } from 'Class86.js';
import { Class374 } from 'Class374.js';
import { Class541 } from 'Class541.js';
import { Class675 } from 'Class675.js';
import { Class674 } from 'Class674.js';
import { Class438 } from 'Class438.js';
export var Class679 = function () {
    var a4 = {};
    var aF;
    var s = 500;
    var aD = 400;
    var ao;
    a4.member6946 = ao;
    var an;
    a4.member6817 = an;
    var al;
    a4.member9835 = al;
    var aj;
    a4.member6947 = aj;
    var ai;
    a4.member6829 = ai;
    var ag;
    a4.member6950 = ag;
    var af;
    a4.member6961 = af;
    var ad;
    a4.member6945 = ad;
    var Z;
    a4.member6951 = Z;
    var ae = false;
    a4.isOpen = function () {
        return ae;
    };
    var aE = false;
    var C = undefined;
    var g;
    var aL = 0;
    a4.member2975 = function () {
        return aL;
    };
    var a2 = new Array(s);
    var aQ = 0;
    var a = new Array(s);
    var i = 0;
    var ax = new Array(s);
    var d = 0;
    var Q = new Array(s);
    var aq = 0;
    a4.member9543 = function () {
        return aq;
    };
    var J = {};
    var y = Class103();
    var D = -1;
    a4.member9836 = function () {
        return D;
    };
    a4.member9561 = function (a6) {
        D = a6;
    };
    var I, G, aI, aJ;
    var O, N, E, h;
    var aT = undefined;
    a4.member9541 = function () {
        return aT;
    };
    var a0 = undefined;
    var k = undefined;
    a4.member9542 = function () {
        return k;
    };
    var aK = new Array(0);
    a4.member9200 = function () {
        return aK;
    };
    var ac = 0;
    var aU = 1;
    var aS = 2;
    var q = ac;
    var aM = undefined;
    var b;
    var az;
    a4.member9546 = function () {
        return az;
    };
    var aY;
    var am = undefined;
    a4.member9559 = function (a6) {
        if (a6) {
            am = az;
        } else {
            am = aY;
        }
    };
    var W = a4.member9559;
    a4.member9545 = function () {
        var a6 = am === az;
        az = Class676(aF);
        if (a6) {
            am = az;
        }
    };
    var K = 0;
    var S = 8;
    a4.member9837 = S;
    var ak = [
        Class635.member9490,
        Class635.member9491,
        Class635.member9492,
        Class635.member9493,
        Class635.member9494,
        Class635.member9495,
        Class635.member9496,
        Class635.member9497,
        Class635.member9498,
        Class635.member9499,
        Class635.member9518,
        Class635.member9519,
        Class635.member9520,
        Class635.member9521,
        Class635.member9522,
        Class635.member9523,
        Class635.member9524,
        Class635.member9525,
        Class635.member9526,
        Class635.member9527
    ];
    var ah = new Array(S);
    var aX = new Array(S);
    var V = new Array(S);
    a4.member9838 = function (a6, a8, a7, a9) {
        ah[a6 - 1] = a8;
        aX[a6 - 1] = a7;
        V[a6 - 1] = a9;
    };
    var L;
    var m = -1;
    a4.member9839 = function (a7, a6) {
        L = a7;
        m = a6;
    };
    var aN = Class49.create();
    var a1 = new Float32Array(4);
    var ap = new Float32Array(4);
    var aR = Class41.create();
    var T = [];
    a4.member25 = function (a7) {
        aF = a7;
        Class678.member25(aF);
        Class636.member25(aF);
        b = Class546();
        aY = Class673(aF);
        az = Class676(aF);
        W(false);
        var a6 = aF.clientParameters.member7138.value.id;
        a4.member6946 = ao = Class443.member6946[a6];
        a4.member6817 = an = Class443.member6817[a6];
        a4.member9835 = al = Class443.member6955[a6];
        a4.member6947 = aj = Class443.member6947[a6];
        a4.member6829 = ai = Class443.member6829[a6];
        a4.member6950 = ag = Class443.member6950[a6];
        a4.member6961 = af = Class443.member6961[a6];
        a4.member6945 = ad = Class443.member6945[a6];
        a4.member6951 = Z = Class443.member6951[a6];
        L = Class443.member6948[a6];
        g = Class677({
            member9823: '',
            member9824: an,
            member9825: Class635.member6817,
            member9826: -1,
            member9827: -1,
            member9828: -1,
            member9829: 0,
            member9830: 0,
            member9831: true,
            otherLevel: false,
            member9832: -1,
            member9833: false,
            member9834: null
        });
    };
    var aC = a4.member25;
    a4.member7183 = function (a7, a6) {
        U();
    };
    var aW = a4.member7183;
    var ar = function (bh, a7, be, bb, a6, a8) {
        var a9 = 0;
        if (a8 !== undefined) {
            a9 = a8;
        }
        return bh.x >= a7 - a9 && bh.x <= a7 + bb + a9 && bh.y >= be - a9 && bh.y <= be + a6 + a9;
    };
    var au = function (a7, a6) {
        return a7 !== undefined && a7.eventOccurred(a6, aF.member7619.member9234(), aF.member7619.member9235());
    };
    a4.member9816 = function (a9, a6, a8) {
        a8 += am.member9797();
        for (var a7 = 0; a7 < a6; a7++) {
            if (a9.y > a8 - am.member9789() && a9.y < a8 + am.member9791()) {
                return a6 - 1 - a7;
            }
            a8 += am.member9788();
        }
        return -1;
    };
    var H = a4.member9816;
    var aZ = function () {
        aw.member905(200);
        var bh = aF.member6116.member9589();
        b.member487();
        i = 0;
        d = 0;
        a2.length = aL;
        var a8 = aL;
        for (var bD = 0; bD < a8; bD++) {
            var a7 = a2[bD];
            var bb = a7.member9814();
            if (bb.id < 1000) {
                a2.splice(bD, 1);
                bD--;
                a8--;
                if (bb === Class635.member9501 || bb === Class635.member9469 || bb === Class635.member9474 || bb === Class635.member9482 || bb === Class635.member9480 || bb === Class635.member9481 || bb === Class635.member8065) {
                    Q[d++] = a7;
                } else {
                    ax[i++] = a7;
                }
            }
        }
        a2.length = a8;
        ax.length = i;
        a2.push.apply(a2, ax);
        Q.length = d;
        a2.push.apply(a2, Q);
        var bE = a2;
        if (aQ > 0) {
            a2 = a;
            aL = aQ;
        }
        if (aL > 1) {
            var a6 = aT;
            aT = a2[aL - 1];
            if (aK.length === 0 || a6 !== undefined && !a6.member9822(aT.member9801())) {
                aA();
            }
            a0 = a2[aL - 1];
            if (aL > 2) {
                k = a2[aL - 2];
            } else {
                k = undefined;
            }
        } else {
            aT = undefined;
            a0 = undefined;
            k = undefined;
        }
        var bj = am.member3639();
        if (bj === member47) {
            return;
        }
        var bt = bj.member3598();
        if (!ae) {
            aE = D !== -1 && aL >= D || am.member9788() * aL + am.member9795() > aF.member433.member589();
        }
        var bA;
        var bv = Class298.member3559();
        if (bv !== undefined) {
            bA = bv.position;
        } else {
            bA = Class298.member3558();
        }
        if (ae) {
            if (au(bh.member9840(), bv)) {
                if (C !== undefined && ar(bA, O, N, E, h)) {
                    var bl = H(bA, C.member9813(), N);
                    if (bl !== -1) {
                        var bB = C.member9811.member890();
                        for (var bx = C.member9811.member776(); bx !== null; bx = C.member9811.member777()) {
                            if (bl === --bB) {
                                aB(bx, bA);
                            }
                        }
                    }
                    A();
                } else if (ar(bA, I, G, aI, aJ)) {
                    if (!aE) {
                        var bl = H(bA, aL, G);
                        if (bl !== -1) {
                            aB(a2[bl], bA);
                        }
                        A();
                    } else {
                        var bl = H(bA, aq, G);
                        if (bl !== -1) {
                            var bB = y.member890();
                            for (var bq = y.member776(); bq !== null; bq = y.member777()) {
                                if (bl === --bB) {
                                    aB(bq.member9811.member776(), bA);
                                    A();
                                }
                            }
                        }
                    }
                }
            } else {
                var bm = false;
                if (C !== undefined) {
                    if (!ar(bA, O, N, E, h, 10)) {
                        Y();
                    } else {
                        bm = true;
                    }
                }
                if (!bm) {
                    if (!ar(bA, I, G, aI, aJ, 10)) {
                        A();
                    } else if (aE) {
                        var bl = H(bA, aq, G);
                        var be = G + am.member9797() + (aq - bl) * am.member9788();
                        var bB = y.member890();
                        if (bl !== -1) {
                            for (var bq = y.member776(); bq !== null; bq = y.member777()) {
                                if (bl === --bB && bq.member9813() > 1) {
                                    a4.member9841(bq, be);
                                }
                            }
                        }
                    }
                }
            }
        } else {
            var a9 = au(bh.member9842(), bv);
            var br = au(bh.member9843(), bv);
            var bC = au(bh.member9844(), bv);
            if (a9 || br) {
                if (aF.member4480().member3969() && aL > 2 || t()) {
                    bC = true;
                }
            }
            var bo = Class448.member7105() !== null || aF.member7619.member9226();
            if (bC && aL > 0) {
                if (!bo) {
                    M(bA);
                } else {
                    q = aS;
                }
            } else if (br) {
                if (k !== undefined) {
                    aB(k, bA);
                }
            } else if (a9) {
                if (aT != undefined) {
                    if (bo) {
                        q = aU;
                        aM = aT;
                    } else {
                        aB(aT, bA);
                    }
                } else if (aF.member7619.member8851()) {
                    aF.member7619.member7640();
                }
            }
            if (!bo) {
                q = ac;
                aM = undefined;
            }
        }
        aQ = 0;
        a2 = bE;
    };
    a4.member487 = aZ;
    a4.member9228 = function (a6) {
        if (q === aU) {
            aB(aM, a6);
        } else if (q === aS) {
            M(a6);
        }
        q = ac;
        aM = undefined;
    };
    var F = a4.member9228;
    var aB = function (a6, a8) {
        if (aF.member8233() === Class453.member3549) {
            return;
        }
        var a7 = a6.member9814();
        if (a7.member867 !== undefined) {
            a7.member867(a6);
            if (a7 === Class635.member6229 && a6.member9531() !== Class605.member7343 || a7 === Class635.member8115 || a7 === Class635.member9501) {
                b.member8700(a8.x, a8.y, Class545.member8698);
            } else if (a7 !== Class635.member6817 && a7.type !== Class605.member7343 && a7.type !== Class605.member9170 && a6.member9531() !== Class605.member7343) {
                b.member8700(a8.x, a8.y, Class545.member8699);
            }
        } else if (false) {
        }
        if (a7 === Class635.member9488) {
            return;
        }
        if (aF.member7619.member8851()) {
            aF.member7619.member7640();
        }
    };
    var M = function (bo) {
        if (!aF.member6116.member6117().member8772()) {
            if (aL === 1) {
                return;
            }
        }
        var a7 = am.member3639();
        if (a7 === member47) {
            return;
        }
        var a6 = Class302.member3609(ao, a7);
        var bm;
        if (!aE) {
            var a8;
            for (var bb = 0; bb < aL; bb++) {
                a8 = ab(a2[bb], a7);
                if (a8 > a6) {
                    a6 = a8;
                }
            }
            a6 += 8;
            bm = am.member9788() * aL + 21;
            aJ = am.member9788() * aL + am.member9795();
        } else {
            for (var a9 = y.member776(); a9 !== null; a9 = y.member777()) {
                var bj = a9.member9811.member776();
                var bl = bj.member9539();
                if (bl === '') {
                    bl += a9.member9811.member776().member3637();
                } else {
                    bl += '  >';
                }
                var a8 = Class302.member3609(bl, a7);
                if (a8 > a6) {
                    a6 = a8;
                }
            }
            a6 += 8;
            bm = am.member9788() * aq + 21;
            aJ = am.member9788() * aq + am.member9795();
        }
        a6 += 10;
        var bh = Math.floor(bo.x - a6 / 2);
        if (bh + a6 > aF.member433.member588()) {
            bh = aF.member433.member588() - a6;
        }
        if (bh < 0) {
            bh = 0;
        }
        var be = bo.y;
        if (be + bm > aF.member433.member589()) {
            be = aF.member433.member589() - bm;
        }
        if (be < 0) {
            be = 0;
        }
        I = bh;
        G = be;
        aI = a6;
        ae = true;
    };
    a4.member9841 = function (a9, a6) {
        if (!ae) {
            return;
        }
        var a8 = am.member3639();
        if (a8 === member47) {
            return;
        }
        var a7 = Class302.member3609(ao, a8);
        for (var bj = a9.member9811.member776(); bj !== null; bj = a9.member9811.member777()) {
            var bb = ab(bj, a8);
            if (bb > a7) {
                a7 = bb;
            }
        }
        a7 += 8;
        var bl = am.member9788() * a9.member9813() + 21;
        h = am.member9788() * a9.member9813() + am.member9795();
        var bh = I + aI;
        if (bh + a7 > aF.member433.member588()) {
            bh = I - a7;
        }
        if (bh < 0) {
            bh = 0;
        }
        var be = a6 - am.member9795();
        if (be + bl > aF.member433.member589()) {
            be = aF.member433.member589() - bl;
        }
        if (be < 0) {
            be = 0;
        }
        O = bh;
        N = be;
        E = a7;
        C = a9;
    };
    a4.member9544 = function () {
        Y();
        ae = false;
        aT = undefined;
        k = undefined;
    };
    var A = a4.member9544;
    var Y = function () {
        if (C === undefined) {
            return;
        }
        C = undefined;
    };
    a4.member9802 = function (a6) {
        var a7 = a6.member9538();
        if (a6.member9539() !== null && a6.member9539().length > 0) {
            a7 = a7.concat(al, a6.member9539());
        }
        if (a6.member9540() !== null && a6.member9540().length > 0) {
            a7 = a7.concat(al, a6.member9540());
        }
        return a7;
    };
    var z = a4.member9802;
    var aw = Class105({
        member895: 10,
        member898: function (a6) {
        },
        member897: function (a6) {
            a6.member3606.member512();
            a6.member3606 = undefined;
        }
    });
    a4.member9804 = function (bb) {
        var a9 = aw.find(bb);
        if (a9 === null) {
            var a8 = aF.member995.getFile(Class95.member811, bb, 0, Class96.member840, Class93.member796);
            if (a8 === member47 || a8 === undefined) {
                return member47;
            }
            var a7 = Class80.member605(a8);
            var a6 = Class148.member1495(a7.member600(), a7.member556(), a7.member557(), 0);
            a9 = {
                member9845: true,
                member3606: a6,
                width: a7.member556(),
                height: a7.member557(),
                member1295: a7.member595()
            };
            aw.put(a9, 1, bb);
        }
        return a9;
    };
    var u = a4.member9804;
    var ab = function (be, a8) {
        var bj = z(be);
        var a9 = Class302.member3609(bj, a8);
        var bh = be.member9801();
        if (bh !== null) {
            var bb;
            for (var a7 = 0; a7 < bh.length; a7++) {
                bb = u(bh[a7]);
                if (bb !== member47) {
                    a9 += bb.member1295.left + bb.width + bb.member1295.member596;
                }
            }
        }
        if (be.member9805()) {
            var a6 = Class423.member6130(Class423.member6115.otherLevel);
            if (a6 !== member47 && a6[0] !== undefined && a6[0] !== member47) {
                a9 += a6[0].width + 4;
            }
        }
        return a9;
    };
    a4.member9846 = function () {
        if (a0 === undefined) {
            return false;
        }
        if (a0.member9814() === Class635.member9506) {
            return true;
        }
        return false;
    };
    var t = a4.member9846;
    a4.member9199 = function () {
        var a8 = '';
        var a9 = 0;
        if (Class423.member6130(Class423.member6115.member6111) !== member47) {
            a9 = Class423.member6130(Class423.member6115.member6111).length;
        }
        if (aF.member7619.member8851() && aL < 2) {
            a8 = aF.member7619.member9242() + al + aF.member7619.member9244() + ' -> ';
        } else if (aT !== undefined) {
            a8 = aT.member3637();
            var a7 = aT.member9801();
            if (a7 !== null) {
                for (var a6 = 0; a6 < a7.length; a6++) {
                    a8 = a8.concat(al, '<img=', a9 + a6, '>');
                }
            }
        }
        if (aL > 2) {
            a8 = a8 + '<col=ffffff> / ' + (aL - 2) + aj;
        }
        return a8;
    };
    var r = a4.member9199;
    var aA = function () {
        aK.length = 0;
        if (aT !== undefined && aT.member9801() !== null) {
            var a7 = Class423.member6130(Class423.member6115.member6111);
            if (a7 !== member47) {
                aK = aK.concat(a7);
            }
            var a9 = aT.member9801();
            var a8;
            for (var a6 = 0; a6 < a9.length; a6++) {
                a8 = u(a9[a6]);
                if (a8 !== member47) {
                    aK.push(a8);
                }
            }
        }
    };
    a4.member9265 = function () {
        if (Class448.member7105() !== null) {
            return -1;
        }
        if (!ae) {
            if (aT === undefined) {
                return -1;
            } else {
                return aT.member9265();
            }
        } else {
            var bb = Class298.member3558();
            if (!aE) {
                var a8 = H(bb, aL, G);
                if (a8 !== -1) {
                    return a2[a8].member9265();
                }
            } else if (C !== undefined && ar(bb, O, N, E, h)) {
                var a8 = H(bb, C.member9813(), N);
                if (a8 !== -1) {
                    var a6 = C.member9813();
                    for (var a9 = C.member9811.member776(); a9 !== null; a9 = C.member9811.member777()) {
                        if (a8 === --a6) {
                            return a9.member9265();
                        }
                    }
                }
            } else {
                var a8 = H(bb, aq, G);
                if (a8 !== -1 && ar(bb, I, G, aI, aJ)) {
                    var a6 = y.member890();
                    for (var a7 = y.member776(); a7 !== null; a7 = y.member777()) {
                        if (a8 === --a6) {
                            return a7.member9811.member776().member9265();
                        }
                    }
                }
            }
            return -1;
        }
    };
    a4.member301 = function () {
        ae = false;
        J = {};
        y.member301();
        aq = 0;
        aL = 0;
        g.member884 = undefined;
        g.next = undefined;
        aV(g);
        for (var a6 = 0; a6 < T.length; a6++) {
            T[a6] = undefined;
        }
    };
    var U = a4.member301;
    var a3 = function (bb) {
        var a6 = null;
        var a8 = bb.member8660();
        if (a8 !== null && a8.length > 0) {
            a6 = new Array(0);
            var a7;
            for (var a9 = 0; a9 < a8.length; a9++) {
                a7 = aF.member2970.member3227(Class131.member1229.member1204, a8[a9]);
                if (a7 === member47) {
                    continue;
                }
                a6.push(a7.member8661());
            }
        }
        return a6;
    };
    a4.member9279 = function (bj) {
        var be = null;
        if (bj.member6807() > 0) {
            var a7 = aF.member2970.member3227(Class131.member1214.member1204, bj.member6807());
            if (a7 !== member47) {
                be = a3(a7);
            }
        }
        if (aF.member7619.member8851()) {
            var bh = aF.member7619.member9241();
            var bb = bh !== -1 ? aF.member2970.member3227(Class131.member1215.member1204, bh) : member47;
            if (aF.member7619.member6767(bj).member6672() && (aF.member7619.member9180() & Class604.member7294) !== 0 && (bb === member47 || bj.getParam(bh, bb.member6145()) !== bb.member6145())) {
                v(aF.member7619.member9242(), aF.member7619.member9244() + ' -> ' + bj.member6770(), aF.member7619.member9246(), Class635.member8065, bj.member6807(), 0, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
            }
        }
        for (var a6 = 9; a6 >= 5; a6--) {
            var a8 = o(bj, a6);
            if (a8 !== null) {
                v(a8, bj.member6770(), aF.member7619.member9274(bj, a6), Class635.member9506, bj.member6807(), a6 + 1, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
            }
        }
        var a9 = aF.member7619.member9275(bj);
        if (a9 !== null) {
            v(a9, bj.member6770(), bj.member6779(), Class635.member9488, bj.member6807(), 0, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
        }
        for (var a6 = 4; a6 >= 0; a6--) {
            var a8 = o(bj, a6);
            if (a8 !== null) {
                v(a8, bj.member6770(), aF.member7619.member9274(bj, a6), Class635.member9500, bj.member6807(), a6 + 1, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
            }
        }
        if (aF.member7619.member6767(bj).member6666()) {
            if (bj.member6775() !== null) {
                v(bj.member6775(), '', -1, Class635.member9489, bj.member6807(), 0, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
            } else {
                v(ai, '', -1, Class635.member9489, bj.member6807(), 0, bj.member6722(), bj.member6721(), true, false, bj.member6722() * Math.pow(2, 32) + bj.member6721(), false, be);
            }
        }
    };
    var n = a4.member9279;
    var o = function (a8, a6) {
        var a7 = a8.member6792();
        if (!aF.member7619.member6767(a8).member6667(a6) && a7 !== undefined && a7.member6570() === null) {
            return null;
        } else {
            return a8.member6772(a6);
        }
    };
    a4.member9847 = function (a7) {
        var a8 = aF.member7135().member6453().member4081();
        var a6 = a7.member4081();
        B(a7, a6, a8, true);
    };
    var j = a4.member9847;
    a4.member9848 = function (a7) {
        var a8 = a7.member9345();
        var a6 = a7.member682();
        if (a8 !== undefined) {
            if (a8[4] !== undefined) {
                v(a8[4], a7.member9346(), -1, Class635.member9511, -1, a6, a7.member8472(), 0, true, false, a6, false, null);
            }
            if (a8[3] !== undefined) {
                v(a8[3], a7.member9346(), -1, Class635.member9510, -1, a6, a7.member8472(), 0, true, false, a6, false, null);
            }
            if (a8[2] !== undefined) {
                v(a8[2], a7.member9346(), -1, Class635.member9509, -1, a6, a7.member8472(), 0, true, false, a6, false, null);
            }
            if (a8[1] !== undefined) {
                v(a8[1], a7.member9346(), -1, Class635.member9508, -1, a6, a7.member8472(), 0, true, false, a6, false, null);
            }
            if (a8[0] !== undefined) {
                v(a8[0], a7.member9346(), -1, Class635.member9507, -1, a6, a7.member8472(), 0, true, false, a6, false, null);
            }
        }
    };
    var e = a4.member9848;
    a4.member9217 = function (bj, bh, bq, br) {
        var bb = aF.member6444.member6445();
        if (bb === member47) {
            return;
        }
        if (bb.member4836()) {
            T.length = 0;
            if (aF.member9215.member9419(bj, bh, T)) {
                for (var bA = 0; bA < T.length; bA++) {
                    e(T[bA]);
                }
            }
            return;
        }
        Class49.set(bb.member8338(), aN);
        Class49.member323(bb.member8353(), aN, aN);
        var a8 = Class49.inverse(aN);
        if (a8 !== null) {
            a1[0] = 2 * bj / bq - 1;
            a1[1] = 2 * (br - bh) / br - 1;
            a1[2] = -1;
            a1[3] = 1;
            Class49.member331(aN, a1);
            a1[0] /= a1[3];
            a1[1] /= a1[3];
            a1[2] /= a1[3];
            ap[0] = 2 * bj / bq - 1;
            ap[1] = 2 * (br - bh) / br - 1;
            ap[2] = 1;
            ap[3] = 1;
            Class49.member331(aN, ap);
            ap[0] /= ap[3];
            ap[1] /= ap[3];
            ap[2] /= ap[3];
        } else {
            return;
        }
        if (!aF.member7619.member8851() || (aF.member7619.member9180() & Class604.member9167) !== 0) {
            var a6 = av(bb, a1, ap, 4);
            var bv = -1, bt = -1;
            if (a6 > 0) {
                var a9 = a1[0] + (ap[0] - a1[0]) * a6;
                var a7 = a1[2] + (ap[2] - a1[2]) * a6;
                var bm = aF.member7135().member6453();
                bv = Math.floor((a9 + (bm.member7795() - 1) * Class86.member718 / 2) / Class86.member718);
                bt = Math.floor((a7 + (bm.member7795() - 1) * Class86.member718 / 2) / Class86.member718);
            }
            if (bv !== -1 && bt !== -1) {
                if (aF.member7619.member8851() && (aF.member7619.member9180() & Class604.member9167) !== 0) {
                    var be = aF.member7619;
                    var bC = be.member7745().member7105(be.member9247(), be.member9248());
                    if (bC === null) {
                        be.member7640();
                    } else {
                        v(be.member9242(), ' -> ', be.member9246(), Class635.member9501, -1, 0, bv, bt, true, false, bv << 16 | bt, false, null);
                    }
                } else {
                    a5(bv, bt, Class605.member778);
                }
            }
        }
        T.length = 0;
        bb.member8381(bj, br - bh, T);
        if (T.length > 0) {
            T.sort(x);
        }
        var bl = aF.member7135().member6453().member4081();
        for (var bA = 0; bA < T.length; bA++) {
            var bx = T[bA];
            var bB = bx.member87();
            var bo = bx.member4081();
            if (bB === Class374.member4133) {
                B(bx, bo, bl, false);
            } else if (bB === Class374.member4134) {
                aH(bx, bo, bl);
            } else if (bB === Class374.member4135) {
                X(bx, bo, bl);
            } else if (bB === Class374.member4132 || bB === Class374.member4142) {
                R(bx, bo, bl);
            }
        }
    };
    var c = a4.member9217;
    var x = function (a7, a6) {
        if (a7.member7812 !== undefined || a6.member7812 !== undefined) {
            var a8 = a7.node.member4099();
            var a9 = a6.node.member4099();
            if (Math.floor(a8[0] / Class86.member718) === Math.floor(a9[0] / Class86.member718) && Math.floor(a8[2] / Class86.member718) === Math.floor(a9[2] / Class86.member718)) {
                if (a7.member7812 === undefined) {
                    return -1;
                }
                if (a6.member7812 === undefined) {
                    return 1;
                }
                return a7.member7812() - a6.member7812();
            }
        }
        return a7.member3320().member4187() - a6.member3320().member4187();
    };
    a4.member9181 = function (a6, a8, a7) {
        v(L, '', m, Class635.member6229, -1, a7, a6, a8, true, false, a6 << 16 | a8, false, null);
    };
    var a5 = a4.member9181;
    var aG = 0.001;
    var ay = new Float32Array(3), at = new Float32Array(3);
    var av = function (bb, a9, bl, bj) {
        var bm = Class41.member322(bl, a9, aR);
        var be = aF.member7135().member6453().member4081();
        var bo = bb.member4111();
        var a8 = bb.member4114();
        for (var a7 = 0; a7 < 1 + aG * bj; a7 += aG * bj) {
            Class41.scale(bm, a7, ay);
            Class41.add(ay, a9, ay);
            var bh = be;
            if (bh < 3) {
                if (bo.member4112(Math.floor(ay[0] / Class86.member718), Math.floor(ay[2] / Class86.member718))) {
                    bh++;
                }
            }
            var a6 = a8.member4115(bh, ay[0], ay[2], true);
            if (a6 > ay[1]) {
                if (bj === 1) {
                    return a7;
                } else {
                    if (a7 > 0) {
                        a7 -= aG * bj;
                    }
                    return a7 + av(bb, at, ay, bj - 1) * aG * bj;
                }
            }
            Class41.set(ay, at);
        }
        return -1;
    };
    var aH = function (bC, bB, bm) {
        if (aL >= aD) {
            return;
        }
        var a8 = bC.member3320().member4167();
        if (a8 !== undefined && !a8.member1805(a1, ap)) {
            return;
        }
        var bo = aF.member7135().member6453();
        var bh = bo.member8016();
        var a9 = bC.member7791(true);
        var a6 = bC.member8016();
        var bl = bC.member8017();
        if (bC === bo) {
            if (aF.member7619.member8851()) {
                if ((aF.member7619.member9180() & Class604.member6961) !== 0) {
                    v(aF.member7619.member9242(), aF.member7619.member9244() + ' -> <col=ffffff>' + af, aF.member7619.member9246(), Class635.member9481, -1, 0, 0, 0, true, false, bC.member7649(), false, null);
                }
            }
            return;
        }
        if (bC.member8019() === 0) {
            var bq = true;
            if (bo.member8018() !== -1 && bC.member8018() !== -1) {
                if (Math.abs(bo.member8018() - bC.member8018()) > Math.min(bo.member8018(), bC.member8018())) {
                    bq = false;
                }
            }
            if (a6 >= bl) {
                a9 += (bq ? P(a6, bh) : '') + ' (' + ag + a6 + ')';
            } else {
                a9 += (bq ? P(a6, bh) : '') + ' (' + ag + a6 + '+' + (bl - a6) + ')';
            }
        } else if (bC.member8019() !== -1) {
            a9 += ' (' + Z + bC.member8019() + ')';
        }
        var be = bC.member8020();
        var bt = false;
        var bj = 'ffffff';
        if (be !== undefined && be !== member47 && be.member8685()) {
            bt = true;
            var a7 = be.member8659();
            a9 = be.getName();
            bj = 'ffff00';
            if (a7 !== 0) {
                var bb = aF.member7135().member6453().member8016();
                a9 += P(a7, bb) + ' (' + ag + a7 + ')';
            }
        }
        if (bB !== bm) {
            return;
        }
        if (aF.member7619.member8851()) {
            var bv = aF.member7619.member9241();
            var br = bv !== -1 ? aF.member2970.member3227(Class131.member1215.member1204, bv) : member47;
            if ((aF.member7619.member9180() & Class604.member4134) !== 0 && (br === member47 || br.getParam(bv, br.member6145()) !== br.member6145())) {
                v(aF.member7619.member9242(), aF.member7619.member9244() + ' -> <col=' + bj + '>' + a9, aF.member7619.member9246(), Class635.member9480, -1, bC.member7649(), 0, 0, true, false, bC.member7649(), false, null);
            }
        }
        var bx = aF.member7135().member8223();
        if (bB === bm) {
            for (var bD = S - 1; bD >= 0; bD--) {
                if (ah[bD] !== undefined && ah[bD] !== null) {
                    var bA = 0;
                    if (ah[bD] === ad) {
                        if (bx === Class541.member8593) {
                            bA = 10;
                        } else if (bx === Class541.member8592 && a6 > bh) {
                            bA = 10;
                        }
                        if (bo.member3018() !== 0 && bC.member3018() !== 0) {
                            if (bo.member3018() === bC.member3018()) {
                                bA = 10;
                            } else {
                                bA = 0;
                            }
                        } else if (bC.member7799()) {
                            bA = 10;
                        }
                    } else if (V[bD]) {
                        bA = 10;
                    }
                    v(ah[bD], '<col=' + bj + '>' + a9, aX[bD], ak[bD + bA], -1, bC.member7649(), 0, 0, true, false, bC.member7649(), false, null);
                }
            }
        } else if (!bt) {
            v('<col=cccccc>' + a9, '', -1, -1, -1, bC.member7649(), 0, 0, true, false, bC.member7649(), false, null);
        }
        if (bB === bm && !bt) {
            for (var bD = 0; bD < aL; bD++) {
                if (a2[bD].member9814() === Class635.member6229) {
                    a2[bD].member9820('<col=ffffff>' + a9);
                    break;
                }
            }
        }
    };
    var P = function (a6, a7) {
        var a8 = a7 - a6;
        if (a8 < -9) {
            return '<col=0xff0000>';
        }
        if (a8 < -6) {
            return '<col=0xff3000>';
        }
        if (a8 < -3) {
            return '<col=0xff7000>';
        }
        if (a8 < 0) {
            return '<col=0xffb000>';
        }
        if (a8 > 9) {
            return '<col=0x00ff00>';
        }
        if (a8 > 6) {
            return '<col=0x40ff00>';
        }
        if (a8 > 3) {
            return '<col=0x80ff00>';
        }
        if (a8 > 0) {
            return '<col=0xc0ff00>';
        }
        return '<col=0xffff00>';
    };
    var B = function (bj, bA, bh, a8) {
        if (aL >= aD) {
            return;
        }
        var bq = bj.member9627();
        if (bq === member47 || bq === undefined) {
            return;
        }
        var br = bj.member3009();
        if (!bq.member2985()) {
            return;
        }
        var bb = bj.member8659();
        if (bb !== 0) {
            var a6 = aF.member7135().member6453().member8016();
            br += P(bb, a6) + ' (' + ag + bb + ')';
        }
        var a7 = a3(bq);
        if (bA !== bh) {
            return;
        }
        var a9 = bj.member3320().member4167();
        if (a9 !== undefined && !a9.member1805(a1, ap)) {
            return;
        }
        if (aF.member7619.member8851()) {
            var bx = aF.member7619.member9241();
            var bv = bx !== -1 ? aF.member2970.member3227(Class131.member1215.member1204, bx) : member47;
            if ((aF.member7619.member9180() & Class604.member4133) !== 0 && (bv === member47 || bv.getParam(bx, bv.member6145()) !== bv.member6145())) {
                v(aF.member7619.member9242(), aF.member7619.member9244() + ' -> <col=ffff00>' + br, aF.member7619.member9246(), Class635.member9474, -1, bj.member7649(), 0, 0, true, false, bj.member7649(), false, a7, a8);
            }
        } else {
            var be = bq.member8656();
            if (be === member47) {
                return;
            }
            var bl = bj.member9849();
            for (var bm = be.length - 1; bm >= 0; bm--) {
                if (be[bm] === undefined || be[bm] === null || (bl & 1 << bm) !== 0) {
                    continue;
                }
                var bo;
                if (bm === 0) {
                    bo = Class635.member9475;
                } else if (bm === 1) {
                    bo = Class635.member9476;
                } else if (bm === 2) {
                    bo = Class635.member9477;
                } else if (bm === 3) {
                    bo = Class635.member9478;
                } else if (bm === 4) {
                    bo = Class635.member9479;
                } else if (bm === 5) {
                    bo = Class635.member9504;
                }
                if (bj.member9627().member8658() === 1 && (be[bm] === Class443.member6945[aF.clientParameters.member7138.value.id] || be[bm] === Class443.member6944[aF.clientParameters.member7138.value.id]) && bj.member8659() > aF.member7135().member6453().member8016()) {
                    bo = bo.member9528;
                }
                var bt = bq.member8657(bm);
                if (bt === -1) {
                    bt = aF.member7619.member9254();
                }
                v(be[bm], '<col=ffff00>' + br, bt, bo, -1, bj.member7649(), 0, 0, true, false, bj.member7649(), false, a7, a8);
            }
        }
    };
    var R = function (be, bt, bb) {
        var bj = be.member4151();
        var a8 = be.member4152();
        if (bt !== bb) {
            return;
        }
        var a9 = be.member3320().member4167();
        if (a9 !== undefined && !a9.member1805(a1, ap)) {
            return;
        }
        var a7 = be.member4153();
        var a6 = a3(bj);
        if (aF.member7619.member8851()) {
            var br = aF.member7619.member9241();
            var bq = br !== -1 ? aF.member2970.member3227(Class131.member1215.member1204, br) : member47;
            if ((aF.member7619.member9180() & Class604.member4132) !== 0 && (bq === member47 || bq.getParam(br, bq.member6145()) !== bq.member6145())) {
                v(aF.member7619.member9242(), aF.member7619.member9244() + ' -> <col=00ffff>' + bj.getName(), aF.member7619.member9246(), Class635.member9469, -1, a8.member682(), a7.x, a7.member756, true, false, a7.x << 16 | a7.member756, false, a6);
            }
        } else {
            var bm = bj.member8656();
            if (bm === member47) {
                return;
            }
            for (var bh = bm.length - 1; bh >= 0; bh--) {
                if (bm[bh] === undefined || bm[bh] === null) {
                    continue;
                }
                var bl;
                if (bh === 0) {
                    bl = Class635.member9470;
                } else if (bh === 1) {
                    bl = Class635.member9471;
                } else if (bh === 2) {
                    bl = Class635.member9472;
                } else if (bh === 3) {
                    bl = Class635.member9473;
                } else if (bh === 4) {
                    bl = Class635.member9502;
                } else if (bh === 5) {
                    bl = Class635.member9503;
                }
                var bo = bj.member8657(bh);
                if (bo === -1) {
                    bo = aF.member7619.member9254();
                }
                v(bm[bh], '<col=00ffff>' + bj.getName(), bo, bl, -1, a8.member682(), a7.x, a7.member756, true, false, a7.x << 16 | a7.member756, false, a6);
            }
        }
    };
    var X = function (bB, bA, bq) {
        if (bA !== bq) {
            return;
        }
        var bb = bB.member3320().member4167();
        if (bb !== undefined && !bb.member1805(a1, ap)) {
            return;
        }
        for (var bC = bB.member890() - 1; bC >= 0; bC--) {
            var bo = bB.member9595(bC);
            var bv = aF.member2970.member3227(Class131.member1214.member1204, bo.member9764);
            if (bv === member47) {
                return;
            }
            var bl = aF.member6116.member9589();
            var bx;
            if (bv.member9587()) {
                bx = bv.member9588();
            } else if (bv.member9584()) {
                bx = bl.member9590();
            } else {
                bx = bl.member9591();
            }
            var a8 = a3(bv);
            var bj = aF.member7619;
            if (bA === bq) {
                var a7 = Math.floor(bB.member8493().member3454[0] / Class86.member718);
                var a6 = Math.floor(bB.member8493().member3454[2] / Class86.member718);
                if (bj.member8851()) {
                    var bm = member47;
                    if (bj.member9241() !== -1) {
                        bm = aF.member2970.member3227(Class131.member1215.member1204, bj.getTargetParam());
                    }
                    if ((bj.member9180() & Class604.member4135) !== 0 && (bm === member47 || bv.getParam(bj.getTargetParam(), bm.member6145()) !== bm.getDefaultInt())) {
                        v(bj.member9242(), bj.member9244() + ' -> <col=' + bx.toString(16) + '> ' + bv.getName(), bj.member9246(), Class635.member9482, -1, bo.member9764, a7, a6, true, false, bC, false, a8);
                    }
                }
                var br = bv.member9577();
                for (var bt = br.length - 1; bt >= 0; bt--) {
                    if (br[bt] !== null) {
                        var bh;
                        var a9 = bj.member9254();
                        if (bt == 0) {
                            bh = Class635.member9483;
                        } else if (bt == 1) {
                            bh = Class635.member9484;
                        } else if (bt == 2) {
                            bh = Class635.member9485;
                        } else if (bt == 3) {
                            bh = Class635.member9486;
                        } else if (bt == 4) {
                            bh = Class635.member9487;
                        } else if (bt == 5) {
                            bh = Class635.member9505;
                        }
                        var be = bv.member8657(bt);
                        if (be !== -1) {
                            a9 = be;
                        }
                        v(br[bt], '<col=' + bx.toString(16) + '>' + bv.getName(), a9, bh, -1, bo.member9764, a7, a6, true, false, bC, false, a8);
                    }
                }
            }
        }
    };
    var v = function (br, bt, bo, bx, bm, bl, bh, be, bb, bq, a9, a8, a7, a6) {
        if (ae || aL >= s) {
            return;
        }
        if (bo === -1) {
            bo = aF.member7619.member9253();
        }
        if (a7 !== null && a7 !== undefined) {
            for (var bj = 0; bj < a7.length; bj++) {
                u(a7[bj]);
            }
        }
        var bv = Class677({
            member9824: br,
            member9823: bt,
            member9825: bx,
            member9826: bo,
            member9850: bx,
            member9827: bm,
            member9828: bl,
            member9829: bh,
            member9830: be,
            member9831: bb,
            otherLevel: bq,
            member9832: a9,
            member9833: a8,
            member9834: a7
        });
        aV(bv, a6);
    };
    var aV = function (bb, a9) {
        if (a9) {
            a[aQ++] = bb;
        } else {
            a2[aL++] = bb;
        }
        var a7 = undefined;
        if (!bb.member9819() && bb.member9539() !== '') {
            var a6 = bb.member9818();
            var a8 = J[a6];
            if (a8 !== undefined) {
                a7 = a8[bb.member9539()];
                if (a7 === undefined) {
                    a8[bb.member9539()] = Class675(bb.member9539());
                    a7 = J[a6][bb.member9539()];
                }
            } else {
                a7 = Class675(bb.member9539());
                J[a6] = {};
                J[a6][bb.member9539()] = a7;
            }
        } else {
            a7 = Class675(bb.member9539());
        }
        if (a7.member2038(bb)) {
            aO(a7);
        }
    };
    a4.member9271 = function (a7) {
        for (var a8 in a2) {
            var a6 = a2[a8];
            if (a6.member9814().type === Class605.member7343 && a6.member9530() >> 16 === a7) {
                a2.splice(a8, 1);
                aL--;
            }
        }
    };
    var aO = function (a6) {
        var a8 = false;
        if (a6.member884 !== undefined) {
            y.unlink(a6);
        }
        for (var a7 = y.member776(); a7 !== null; a7 = y.member777()) {
            if (Class674.member9809(a6.member2703().id, a7.member2703().id)) {
                y.member888(a6, a7);
                a8 = true;
                break;
            }
        }
        if (!a8) {
            y.member887(a6);
        }
        aq = y.member890();
    };
    a4.member9851 = function (a7) {
        for (var a6 = 0; a6 < aL; a6++) {
            var a8 = a2[a6];
            if (a8.member9814().type === Class605.member4133 && a8.member2794() === a7) {
                return true;
            }
        }
        return false;
    };
    a4.member486 = function () {
        b.member486(aF.member433.member3640);
        if (!ae) {
            return;
        }
        if (aQ > 0) {
            am.member9806(I, G, aI, aJ, a, aQ, false);
        } else {
            am.member9806(I, G, aI, aJ, a2, aL, aE, O, N, E, h, C, y, aq);
        }
    };
    var aa = a4.member486;
    a4.member9815 = function () {
        if (!ae) {
            return;
        }
        A();
        var a6 = I + width / 2;
        if (I + width > aF.member433.member588()) {
            a6 = aF.member433.member588() - width;
        }
        if (a6 < 0) {
            a6 = 0;
        }
        openMiniMenu(a6, G);
    };
    var aP = a4.member9815;
    a4.member9560 = function (be, a8) {
        var a7 = aF.member7619.member7745();
        if (!ae || a7 === undefined) {
            return false;
        }
        var bj = a7.member7105(be, a8);
        if (bj === member47) {
            return false;
        }
        if (a8 !== -1 || bj.member2794() !== Class438.member6632) {
            for (var a6 = 0; a6 < aL; a6++) {
                var bb = a2[a6];
                if (bb.member9529() === a8 && bb.member9530() === bj.member6720() && bb.member9814().type === Class605.member7343) {
                    return true;
                }
            }
        } else {
            for (var a6 = 0; a6 < aL; a6++) {
                var bb = a2[a6];
                if (bb.member9814().type === Class605.member7343) {
                    var a9 = a7.member7438(bb.member9530());
                    while (a9 !== member47 && a9 !== undefined) {
                        if (a9.member6720() === bj.member6720()) {
                            return true;
                        }
                        var bh = a7.member7439(a9.member6719(), false);
                        a9 = aF.member7619.member7466(a9, bh);
                    }
                }
            }
        }
        return false;
    };
    return a4;
}();